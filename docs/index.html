<!DOCTYPE html>
<html lang="es" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CDRS AnalyzerPRO · V1.0.0</title>
  <meta name="theme-color" content="#0a1f66" />
  <link rel="icon" type="image/svg+xml" href="assets/logo.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <!-- Tailwind Play CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { sans: ['Inter','ui-sans-serif','system-ui'] },
          colors: {
            brand: {
              50:'#eff6ff',100:'#dbeafe',200:'#bfdbfe',300:'#93c5fd',400:'#60a5fa',
              500:'#3b82f6',600:'#2563eb',700:'#1d4ed8',800:'#1e40af',900:'#1e3a8a',950:'#0a1f66'
            },
            cave: {
              900:'#0b1020', 800:'#0e1630', 700:'#0f1b3a', 600:'#0f2148'
            }
          },
          boxShadow: {
            'glow': '0 0 0 1px rgba(96,165,250,.15), 0 0 25px rgba(37,99,235,.25)',
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="bg-cave-900 text-slate-100 antialiased">
  <!-- Loader -->
  <div id="app-loader" class="fixed inset-0 z-[60] grid place-items-center bg-cave-900">
    <div class="text-center">
      <div class="mx-auto mb-6 h-16 w-16 animate-spin rounded-full border-4 border-brand-600 border-t-transparent"></div>
      <h1 class="text-xl font-semibold tracking-wide">Cargando recursos...</h1>
      <p class="mt-2 text-sm text-slate-300">Organizando entorno para iniciar análisis...</p>
    </div>
  </div>

  <div class="min-h-screen flex">
    <!-- Sidebar -->
    <aside id="sidebar" class="hidden md:flex w-72 flex-col bg-cave-800/80 backdrop-blur border-r border-brand-800/40">
      <div class="px-5 py-6 flex items-center gap-3 border-b border-brand-800/30">
        <img src="assets/logo.svg" class="h-9 w-9" alt="logo">
        <div>
          <div class="font-bold leading-5">CDRS AnalyzerPRO</div>
          <div class="text-xs text-slate-400">Análisis masivo de datos</div>
        </div>
      </div>
      <nav class="p-3 space-y-2" id="side-nav">
        <button data-tab="dashboard" class="nav-btn active"><span>Dashboard</span></button>
        <div class="pt-2 text-xs uppercase tracking-widest text-slate-400 px-3">Operadoras</div>
        <button data-tab="claro" class="nav-btn"><span>Claro</span></button>
        <button data-tab="movistar" class="nav-btn"><span>Movistar</span></button>
        <button data-tab="tigo" class="nav-btn"><span>Tigo</span></button>
        <button data-tab="wom" class="nav-btn"><span>WOM</span></button>
      </nav>

      <!-- Footer bonito centrado -->
      <div id="sidebar-footer" class="mt-auto px-4 py-5 text-xs text-slate-300 border-t border-brand-800/30">
        <div class="text-center space-y-1">
          <div class="font-semibold tracking-wide">D-TECH SOLUTIONS</div>
          <div class="opacity-90">Desarrollador: <b>Devinson Mena</b></div>
          <div class="opacity-80">Colaboradores: Jamer Guzmán · Esteban Jiménez</div>
          <div class="opacity-80">“GAELI”</div>
          <div class="pt-2 text-[11px] opacity-70">© <span id="year-copy"></span> CDRS Analyzer Pro. Todos los derechos reservados.</div>
        </div>
      </div>
    </aside>

    <!-- Main -->
    <main class="flex-1">
      <!-- Top bar -->
      <header class="sticky top-0 z-50 flex items-center justify-between bg-cave-800/60 backdrop-blur border-b border-brand-800/25 px-4 md:px-6 py-3">
        <div class="flex items-center gap-3">
          <button id="open-drawer" class="md:hidden p-2 rounded-lg hover:bg-cave-700 border border-brand-800/30" title="Menú">
            <span class="sr-only">Abrir menú</span> ☰
          </button>
          <!-- Botón para ocultar/mostrar el panel lateral en escritorio -->
          <button id="toggle-sidebar" class="hidden md:inline-flex p-2 rounded-lg hover:bg-cave-700 border border-brand-800/30" title="Ocultar/mostrar panel lateral">⟷</button>
          <h1 id="tab-title" class="text-lg md:text-xl font-semibold">Dashboard</h1>
        </div>
        <div class="flex items-center gap-2">
          <!-- Versión visible -->
          <span id="app-version" class="version-pill hidden sm:inline-flex"></span>
          <a href="README.md" class="text-xs underline hover:text-brand-300" target="_blank">Guía</a>
          <a id="export-summary" class="btn-secondary" href="#" title="Exportar resumen (XLSX)">Exportar resumen</a>
        </div>
      </header>

      <!-- Content -->
      <section id="content" class="p-4 md:p-6 space-y-6">
        <!-- Dashboard -->
        <div id="tab-dashboard" class="tab-panel active">
          <div class="grid gap-4 md:grid-cols-3">
            <div class="card">
              <div class="text-sm text-slate-300 mb-2">Capacidad objetivo</div>
              <div class="text-3xl font-bold">1.000.000<span class="text-base font-medium text-slate-400 ml-2">filas</span></div>
              <p class="mt-2 text-sm text-slate-400">Soporte óptimo con CSV streaming. Para XLSX muy grandes, convierta a CSV para mayor estabilidad.</p>
            </div>
            <div class="card">
              <div class="text-sm text-slate-300 mb-2">Estado</div>
              <div id="status-pill" class="inline-flex items-center gap-2 rounded-full border border-brand-800/40 px-3 py-1">
                <span class="h-2 w-2 rounded-full bg-emerald-400 animate-pulse"></span>
                <span class="text-sm">Listo</span>
              </div>
              <p class="mt-2 text-sm text-slate-400">Arrastra y suelta tus archivos Excel o CSV en la pestaña de cada operadora.</p>
            </div>
            <div class="card">
              <div class="text-sm text-slate-300 mb-2">Exportaciones</div>
              <div class="text-3xl font-bold">Excel / CSV</div>
              <p class="mt-2 text-sm text-slate-400">Descarga resultados filtrados o resúmenes con un clic.</p>
            </div>
          </div>

          <div class="card mt-4">
            <h2 class="text-lg font-semibold mb-3">Cómo usar</h2>
            <ol class="list-decimal ml-5 space-y-2 text-slate-300/95">
              <li>Elige una pestaña de operadora (Claro, Movistar, Tigo o WOM).</li>
              <li>Carga tu archivo (.xlsx, .xls o .csv). Para archivos muy grandes, preferir .csv.</li>
              <li>Mapea columnas: Número, Fecha y Tipo (opcional) según cabecera detectada.</li>
              <li>Aplica filtros (rango de fechas, contiene/excluye, hora, tipo, deduplicación, etc.).</li>
              <li>Usa <b>Ordenar</b>, <b>Mover fila</b> y <b>Mover columna</b> para organizar.</li>
              <li>Exporta resultados a Excel o CSV.</li>
            </ol>
          </div>
        </div>

        <!-- Operator tabs injected by JS -->
        <div id="tabs-container"></div>
      </section>
    </main>
  </div>

  <!-- Drawer for mobile -->
  <div id="drawer" class="fixed inset-0 z-[70] hidden">
    <div class="absolute inset-0 bg-black/60"></div>
    <aside class="absolute left-0 top-0 h-full w-80 bg-cave-800 border-r border-brand-800/30 p-4">
      <div class="flex items-center gap-3 mb-4">
        <img src="assets/logo.svg" class="h-8 w-8" alt="logo">
        <div class="font-semibold">CDRS Analyzer</div>
      </div>
      <nav id="drawer-nav" class="space-y-2">
        <button data-tab="dashboard" class="nav-btn active"><span>Dashboard</span></button>
        <div class="pt-2 text-xs uppercase tracking-widest text-slate-400 px-1">Operadoras</div>
        <button data-tab="claro" class="nav-btn"><span>Claro</span></button>
        <button data-tab="movistar" class="nav-btn"><span>Movistar</span></button>
        <button data-tab="tigo" class="nav-btn"><span>Tigo</span></button>
        <button data-tab="wom" class="nav-btn"><span>WOM</span></button>
      </nav>
      <button id="close-drawer" class="mt-6 w-full btn-secondary">Cerrar</button>
    </aside>
  </div>

  <!-- Modal reutilizable para "Cómo usar filtros" -->
  <div id="modal" class="fixed inset-0 z-[80] hidden">
    <div class="absolute inset-0 bg-black/60"></div>
    <div class="modal-card">
      <div class="modal-header">
        <h3 id="modal-title" class="text-lg font-semibold">Cómo usar filtros</h3>
        <button id="modal-close" class="btn-secondary px-3 py-1 text-sm">Cerrar</button>
      </div>
      <div id="modal-body" class="modal-body"></div>
    </div>
  </div>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- App -->
  <script src="app.js"></script>
</body>
</html>
